<%- include('../layout', { body: '' }) %>
<h2>Reports</h2>
<form class="row g-3 mb-3">
  <div class="col-auto">
    <label class="form-label">Start Date</label>
    <input class="form-control" type="date" name="start_date" value="<%= start_date %>">
  </div>
  <div class="col-auto">
    <label class="form-label">End Date</label>
    <input class="form-control" type="date" name="end_date" value="<%= end_date %>">
  </div>
  <div class="col-auto align-self-end">
    <button class="btn btn-primary">Filter</button>
  </div>
</form>

<div class="row mb-3">
  <div class="col-md-4">
    <div class="card">
      <div class="card-body">
        <h5>Total Revenue</h5>
        <p class="display-6">$<%= totals.revenue || 0 %></p>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card">
      <div class="card-body">
        <h5>Transactions</h5>
        <p class="display-6"><%= totals.transactions || 0 %></p>
      </div>
    </div>
  </div>
</div>

<h4>Top Products</h4>
<table class="table table-sm">
  <thead>
    <tr><th>Product</th><th>Qty Sold</th><th>Revenue</th></tr>
  </thead>
  <tbody>
    <% topProducts.forEach(p => { %>
      <tr>
        <td><%= p.name %></td>
        <td><%= p.qty_sold %></td>
        <td>$<%= p.revenue %></td>
      </tr>
    <% }) %>
  </tbody>
</table>

<h4>Low Stock (Bottom 10)</h4>
<table class="table table-sm">
  <thead>
    <tr><th>Product</th><th>Qty</th></tr>
  </thead>
  <tbody>
    <% inventory.forEach(i => { %>
      <tr>
        <td><%= i.name %></td>
        <td><%= i.quantity_on_hand %></td>
      </tr>
    <% }) %>
  </tbody>
</table>
